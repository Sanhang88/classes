define("wiki-lemma:widget/lemma_content/mainContent/lemmaReference/lemmaReferenceTip/lemmaReferenceTip",function(e,i,n){var t=e("wiki-common:widget/lib/jquery/jquery"),f=e("wiki-common:widget/lib/jsmart/jsmart"),r=new f('{%foreach $refList as $ref%}\n<div class="reference-tip__item reference-tip__item--type{%$ref.type|f_escape_xml%}">\n{%if $ref.type==1%}{%if ($refList|count)>1%}\n[{%$ref.index|f_escape_xml%}]&nbsp;{%/if%}\n{%$ref.title|f_escape_xml%}&nbsp;{%if $ref.site%}．{%$ref.site|f_escape_xml%}{%/if%}\n{%else if $ref.type==2%}\n{%if ($refList|count)>1%}\n[{%$ref.index|f_escape_xml%}]&nbsp;{%/if%}\n{%if $ref.author%}{%$ref.author|f_escape_xml%}{%/if%}\n{%if $ref.title%}．{%$ref.title|f_escape_xml%}{%/if%}\n{%if $ref.place%}．{%$ref.place|f_escape_xml%}{%/if%}\n{%if $ref.publisher%}：{%$ref.publisher|f_escape_xml%}{%/if%}\n{%if $ref.publishYear%}，{%$ref.publishYear|f_escape_xml%}{%/if%}\n{%else if $ref.type==3%}\n{%if ($refList|count)>1%}\n[{%$ref.index|f_escape_xml%}]&nbsp;{%/if%}\n{%$ref.text|f_escape_xml%}{%elseif $ref.type == "4"%}\n<div class="reference-tip__item--type4__content \n		{%if $ref.doubtStatus==1||$ref.doubtStatus==2%}\n			has-doubt\n		{%/if%}">\n{%if ($refList|count)>1%}\n[{%$ref.index|f_escape_xml%}]&nbsp;{%/if%}\n{%if $ref.name%}{%$ref.name|f_escape_xml%}．{%/if%}{%if $ref.typeName%}{%$ref.typeName|f_escape_xml%}．{%/if%}\n{%if $ref.isPublic > 0%}公开．{%else%}非公开．{%/if%}\n<span class="type4__remarks">\n由词条本人提供</span>\n{%if $ref.doubtStatus==1%}<span class="doubt-tag">已失效</span>\n{%/if%}\n{%if $ref.doubtStatus==2%}<span class="doubt-tag">有争议</span>\n{%/if%}\n</div>\n{%if $ref.isPublic > 0%}\n{%if $ref.imgs.length>0%}\n<div class=\'img-preview-container\'>\n{%foreach from=$ref.imgs item=img%}\n<a href="{%\'http://imgsrc.baidu.com/baike/pic/item/\'|cat:$img.url|cat:\'.png\'%}" target="_blank">\n<div class="img-preview-container__img" style="background-image:url({%\'http://imgsrc.baidu.com/baike/pic/item/\'|cat:$img.url|cat:\'.png\'%})"></div>\n</a>\n{%/foreach%}\n</div>\n{%/if%}\n{%/if%}\n<a class="type4-detail-link" nslog-type="10090103" title="{%$ref.typeName|f_escape_xml%}" href="/personal/question/{%$lemmaTitle|f_escape_path%}/{%$subLemmaId|f_escape_path%}/{%$ref.id|f_escape_path%}" target="_blank">查看详情</a>\n{%/if%}\n</div>\n{%/foreach%}'),a=e("wiki-common:widget/component/nslog/nslog"),s=function(e){function i(){for(var i=!1,n=0;n<e.reference.length;n++){var t=e.reference[n];4===parseInt(t.type,10)&&(i=!0)}i&&a(10090101)}function n(i){for(var n=0;n<e.reference.length;n++){var t=e.reference[n];if(parseInt(t.index,10)===parseInt(i,10))return t}return null}var f=['<div class="reference-tip J-referenceTip">',"<table><tr>",'<td class="content"></td>','<td class="title" valign="middle">参考资料</td>',"</tr></table>",'<em class="triangle-bg"></em>','<em class="triangle-border"></em>',"</div>"].join(""),s=t(f),l=this,c=function(e){for(var i=e.toString().split("-"),n=parseInt(i[0],10),t=parseInt(i[i.length-1],10),f=[],r=n;t>=r;r++)f.push(r);return f};i();var o=null;this.display=function(i,t){if(!o||!i.is(o)){o=i;for(var f=c(t),l=i.offset(),m=[],p=!1,u=0;u<f.length;u++){var d=n(f[u]);d&&(4===parseInt(d.type,10)&&(p=!0),m.push(d))}p&&a(10090102);var _=r.fetch({refList:m,subLemmaId:e.subLemmaId,lemmaTitle:e.lemmaTitle});s.find(".content").html(_),s.css({left:l.left-10,top:l.top-s.height()-15}),this.show()}},this.show=function(){s.show()},this.hide=function(){o=null,s.hide()};var m=function(){var e=null;t(document.body).on("mouseover","sup",function(){t(this).hasClass("normal")||(e&&(clearTimeout(e),e=null),l.display(t(this),t(this).data("sup")))}).on("mouseout","sup",function(){e&&(clearTimeout(e),e=null),e=setTimeout(function(){l.hide()},200)}).on("mouseover",".J-referenceTip",function(){e&&(clearTimeout(e),e=null)}).on("mouseout",".J-referenceTip",function(){e&&(clearTimeout(e),e=null),e=setTimeout(function(){l.hide()},200)}),s.appendTo(t(document.body))};m()};n.exports=s});